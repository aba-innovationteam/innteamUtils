<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="innteamUtils">
<title>Logit Regression • innteamUtils</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.2/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logit Regression">
<meta property="og:description" content="innteamUtils">
<meta property="og:image" content="https://aba-innovationteam.github.io/innteamUtils/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">innteamUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Datasets.html">Datasets for Common Activities</a>
    <a class="dropdown-item" href="../articles/Logit.html">Logit Regression</a>
    <a class="dropdown-item" href="../articles/theme_innteam.html">Innovation Team Standard R Theming kit</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Logit Regression</h1>
            
      
      
      <div class="d-none name"><code>Logit.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aba-innovationteam.github.io/innteamUtils/">innteamUtils</a></span><span class="op">)</span></span>
<span><span class="co"># Loading required package: data.table</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=aod" class="external-link">aod</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/theme_innteam.html">theme_innteam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Logistic regression, also called a <strong>logit model</strong>, is mostly used to model dichotomous outcome variables. It can be said it is a <strong>Supervised Learning</strong> method used for <strong>Classification</strong>. In the logit model the <em>log odds</em> of the outcome is modeled as a <em>linear combination of the predictor variables</em>.</p>
<p>Please note that the purpose of this page is to show how to use various data analysis commands. It does not cover all aspects of the research process which researchers are expected to do. In particular, it does not cover data cleaning and checking, verification of assumptions, model diagnostics and potential follow-up analyses.</p>
</div>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<p>Currently the following sets are available:</p>
<ul>
<li>
<code>Data Description</code>: a long-format table containing <strong>4 NUTS levels</strong> from EUROSTAT for Italy.<br>
</li>
<li>
<code>Analysis methods you might consider</code>: a wide-format table containing <em>old</em> and <em>new</em> Italian municipalities (and higher level denomination) names.<br>
</li>
<li>
<code>Using the logit model</code>: a long-format table containing <strong>all NACE Rev.2 levels</strong> in Italian language.<br>
</li>
<li>
<code>Things to consider</code>: simple table containing the number of insurance agencies and subagents by Italian province. Strictly for internal use only.</li>
</ul>
<div class="section level3">
<h3 id="description-of-the-data">Description of the Data<a class="anchor" aria-label="anchor" href="#description-of-the-data"></a>
</h3>
<p>For our data analysis below, we are going to expand into graduate school available from the <strong>UCLA Statistics Department</strong> website.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mydata</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"https://stats.idre.ucla.edu/stat/data/binary.csv"</span><span class="op">)</span></span>
<span><span class="co">## view the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#    admit gre  gpa rank</span></span>
<span><span class="co"># 1:     0 380 3.61    3</span></span>
<span><span class="co"># 2:     1 660 3.67    3</span></span>
<span><span class="co"># 3:     1 800 4.00    1</span></span>
<span><span class="co"># 4:     1 640 3.19    4</span></span>
<span><span class="co"># 5:     0 520 2.93    4</span></span>
<span><span class="co"># 6:     1 760 3.00    2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#    admit gre  gpa rank</span></span>
<span><span class="co"># 1:     1 460 3.99    3</span></span>
<span><span class="co"># 2:     0 620 4.00    2</span></span>
<span><span class="co"># 3:     0 560 3.04    3</span></span>
<span><span class="co"># 4:     0 460 2.63    2</span></span>
<span><span class="co"># 5:     0 700 3.65    2</span></span>
<span><span class="co"># 6:     0 600 3.89    3</span></span></code></pre></div>
<p>This dataset has a binary response (outcome, dependent) variable called <code>admit.</code> There are three predictor variables: <code>gre</code>, <code>gpa</code> and <code>rank.</code> We will treat the variables <code>gre</code> and <code>gpa</code> as <strong>continuous.</strong> The variable <code>rank</code> takes on the values 1 through 4. Institutions with a <code>rank</code> of 1 have the highest prestige, while those with a <code>rank</code> of 4 have the lowest. We can get basic descriptives for the entire data set by using <code>summary.</code> To get the standard deviations, we use <code>sapply</code> to apply the <code>sd</code> function to each variable in the dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#      admit             gre             gpa             rank      </span></span>
<span><span class="co">#  Min.   :0.0000   Min.   :220.0   Min.   :2.260   Min.   :1.000  </span></span>
<span><span class="co">#  1st Qu.:0.0000   1st Qu.:520.0   1st Qu.:3.130   1st Qu.:2.000  </span></span>
<span><span class="co">#  Median :0.0000   Median :580.0   Median :3.395   Median :2.000  </span></span>
<span><span class="co">#  Mean   :0.3175   Mean   :587.7   Mean   :3.390   Mean   :2.485  </span></span>
<span><span class="co">#  3rd Qu.:1.0000   3rd Qu.:660.0   3rd Qu.:3.670   3rd Qu.:3.000  </span></span>
<span><span class="co">#  Max.   :1.0000   Max.   :800.0   Max.   :4.000   Max.   :4.000</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="co">#       admit         gre         gpa        rank </span></span>
<span><span class="co">#   0.4660867 115.5165364   0.3805668   0.9444602</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## two-way contingency table of categorical outcome and predictors we want</span></span>
<span><span class="co">## to make sure there are not 0 cells</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">admit</span> <span class="op">+</span> <span class="va">rank</span>, data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">#      rank</span></span>
<span><span class="co"># admit  1  2  3  4</span></span>
<span><span class="co">#     0 28 97 93 55</span></span>
<span><span class="co">#     1 33 54 28 12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-methods-you-might-consider">Analysis methods you might consider<a class="anchor" aria-label="anchor" href="#analysis-methods-you-might-consider"></a>
</h3>
<p>Below is a list of some analysis methods you may have encountered. Some of the methods listed are quite reasonable while others have either fallen out of favor or have limitations.</p>
<ul>
<li><p><strong>Logistic regression</strong>, the focus of this page.</p></li>
<li><p><strong>Probit regression</strong>. Probit analysis will produce results similar logistic regression. The choice of probit versus logit depends largely on individual preferences.</p></li>
<li><p><strong>OLS regression</strong>. When used with a binary response variable, this model is known as a linear probability model and can be used as a way to describe conditional probabilities. However, the errors (i.e., residuals) from the linear probability model violate the homoskedasticity and normality of errors assumptions of OLS regression, resulting in invalid standard errors and hypothesis tests.</p></li>
<li><p><strong>Two-group discriminant function analysis</strong>. A multivariate method for dichotomous outcome variables.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="using-the-logit-model">Using the Logit Model<a class="anchor" aria-label="anchor" href="#using-the-logit-model"></a>
</h3>
<p>The code below estimates a <strong>logistic regression</strong> model using the <code>glm</code> (generalized linear model) function. First, we convert <code>rank</code> to a factor to indicate that rank should be treated as a categorical variable.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">[</span>, <span class="va">rank</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">rank</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">mylogit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">admit</span> <span class="op">~</span> <span class="va">gre</span> <span class="op">+</span> <span class="va">gpa</span> <span class="op">+</span> <span class="va">rank</span>, data <span class="op">=</span> <span class="va">mydata</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span></code></pre></div>
<p>Since we gave our model a name (<code>mylogit</code>), R will not produce any output from our regression. In order to get the results we use the summary command:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Call:</span></span>
<span><span class="co"># glm(formula = admit ~ gre + gpa + rank, family = "binomial", </span></span>
<span><span class="co">#     data = mydata)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Deviance Residuals: </span></span>
<span><span class="co">#     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co"># -1.6268  -0.8662  -0.6388   1.1490   2.0790  </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Coefficients:</span></span>
<span><span class="co">#              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co"># (Intercept) -3.989979   1.139951  -3.500 0.000465 ***</span></span>
<span><span class="co"># gre          0.002264   0.001094   2.070 0.038465 *  </span></span>
<span><span class="co"># gpa          0.804038   0.331819   2.423 0.015388 *  </span></span>
<span><span class="co"># rank2       -0.675443   0.316490  -2.134 0.032829 *  </span></span>
<span><span class="co"># rank3       -1.340204   0.345306  -3.881 0.000104 ***</span></span>
<span><span class="co"># rank4       -1.551464   0.417832  -3.713 0.000205 ***</span></span>
<span><span class="co"># ---</span></span>
<span><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     Null deviance: 499.98  on 399  degrees of freedom</span></span>
<span><span class="co"># Residual deviance: 458.52  on 394  degrees of freedom</span></span>
<span><span class="co"># AIC: 470.52</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<ul>
<li>In the output above, the first thing we see is the call, this is R reminding us what the model we ran was, what options we specified, etc.<br>
</li>
<li>Next we see the deviance residuals, which are a measure of model fit. This part of output shows the distribution of the deviance residuals for individual cases used in the model. Below we discuss how to use summaries of the deviance statistic to assess model fit.<br>
</li>
<li>The next part of the output shows the coefficients, their standard errors, the z-statistic (sometimes called a Wald z-statistic), and the associated p-values. Both <code>gre</code> and <code>gpa</code> are statistically significant, as are the three terms for <code>rank.</code> The logistic regression coefficients give the change in the log odds of the outcome for a one unit increase in the predictor variable.
<ul>
<li>For every one unit change in <code>gre</code>, the log odds of admission (versus non-admission) increases by <code>0.002</code>.<br>
</li>
<li>For a one unit increase in <code>gpa</code>, the log odds of being admitted to graduate school increases by <code>0.804</code>.<br>
</li>
<li>The indicator variables for <code>rank</code> have a slightly different interpretation. For example, having attended an undergraduate institution with <code>rank</code> of 2, versus an institution with a <code>rank</code> of 1, changes the log odds of admission by <code>-0.675</code>.</li>
</ul>
</li>
<li>Below the table of coefficients are fit indices, including the null and deviance residuals and the AIC. Later we show an example of how you can use these values to help assess model fit.</li>
</ul>
<p>We can use the <code>confint</code> function to obtain confidence intervals for the coefficient estimates. Note that for logistic models, confidence intervals are based on the profiled log-likelihood function. We can also get CIs based on just the standard errors by using the default method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## CIs using profiled log-likelihood</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span></span>
<span><span class="co"># Waiting for profiling to be done...</span></span>
<span><span class="co">#                     2.5 %       97.5 %</span></span>
<span><span class="co"># (Intercept) -6.2716202334 -1.792547080</span></span>
<span><span class="co"># gre          0.0001375921  0.004435874</span></span>
<span><span class="co"># gpa          0.1602959439  1.464142727</span></span>
<span><span class="co"># rank2       -1.3008888002 -0.056745722</span></span>
<span><span class="co"># rank3       -2.0276713127 -0.670372346</span></span>
<span><span class="co"># rank4       -2.4000265384 -0.753542605</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## CIs using standard errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint.default</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span></span>
<span><span class="co">#                     2.5 %       97.5 %</span></span>
<span><span class="co"># (Intercept) -6.2242418514 -1.755716295</span></span>
<span><span class="co"># gre          0.0001202298  0.004408622</span></span>
<span><span class="co"># gpa          0.1536836760  1.454391423</span></span>
<span><span class="co"># rank2       -1.2957512650 -0.055134591</span></span>
<span><span class="co"># rank3       -2.0169920597 -0.663415773</span></span>
<span><span class="co"># rank4       -2.3703986294 -0.732528724</span></span></code></pre></div>
<p>We can test for an overall effect of <code>rank</code> using the <code>wald.test</code> function of the <code>aod</code> library. The order in which the coefficients are given in the table of coefficients is the same as the order of the terms in the model. This is important because the<code>wald.test</code> function refers to the coefficients by their order in the model. We use the <code>wald.test</code>function. <code>b</code> supplies the coefficients, while <code>Sigma</code> supplies the variance covariance matrix of the error terms, finally <code>Terms</code> tells R which terms in the model are to be tested, in this case, terms 4, 5, and 6, are the three terms for the levels of <code>rank.</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/aod/man/wald.test.html" class="external-link">wald.test</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span>, Terms <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co"># Wald test:</span></span>
<span><span class="co"># ----------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Chi-squared test:</span></span>
<span><span class="co"># X2 = 20.9, df = 3, P(&gt; X2) = 0.00011</span></span></code></pre></div>
<p>You can also exponentiate the coefficients and interpret them as odds-ratios. <code>R</code> will do this computation for you. To get the exponentiated coefficients, you tell R that you want to exponentiate (exp), and that the object you want to exponentiate is called coefficients and it is part of mylogit (coef(mylogit)). We can use the same logic to get odds ratios and their confidence intervals, by exponentiating the confidence intervals from before. To put it all in one table, we use cbind to bind the coefficients and confidence intervals column-wise.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># (Intercept)         gre         gpa       rank2       rank3       rank4 </span></span>
<span><span class="co">#   0.0185001   1.0022670   2.2345448   0.5089310   0.2617923   0.2119375</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Waiting for profiling to be done...</span></span>
<span><span class="co">#                    OR       2.5 %    97.5 %</span></span>
<span><span class="co"># (Intercept) 0.0185001 0.001889165 0.1665354</span></span>
<span><span class="co"># gre         1.0022670 1.000137602 1.0044457</span></span>
<span><span class="co"># gpa         2.2345448 1.173858216 4.3238349</span></span>
<span><span class="co"># rank2       0.5089310 0.272289674 0.9448343</span></span>
<span><span class="co"># rank3       0.2617923 0.131641717 0.5115181</span></span>
<span><span class="co"># rank4       0.2119375 0.090715546 0.4706961</span></span></code></pre></div>
<p>Now we can say that for a one unit increase in <code>gpa</code>, the odds of being admitted to graduate school (versus not being admitted) increase by a factor of 2.23. For more information on interpreting odds ratios see <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-interpret-odds-ratios-in-logistic-regression/" class="external-link">How do I interpret odds ratios in logistic regression?</a> . Note that while <code>R</code> produces it, the odds ratio for the intercept is not generally interpreted.</p>
<p>You can also use predicted probabilities to help you understand the model. Predicted probabilities can be computed for both categorical and continuous predictor variables. In order to create predicted probabilities we first need to create a new data frame with the values we want the independent variables to take on to create our predictions.</p>
<p>We will start by calculating the predicted probability of admission at each value of <code>rank</code>, holding <code>gre</code> and <code>gpa</code> at their means. First we create and view the data frame.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">gre</span><span class="op">)</span>, gpa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">gpa</span><span class="op">)</span>, rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## view data frame</span></span>
<span><span class="va">newdata1</span></span>
<span><span class="co">#     gre    gpa rank</span></span>
<span><span class="co"># 1 587.7 3.3899    1</span></span>
<span><span class="co"># 2 587.7 3.3899    2</span></span>
<span><span class="co"># 3 587.7 3.3899    3</span></span>
<span><span class="co"># 4 587.7 3.3899    4</span></span></code></pre></div>
<p>These objects must have the same names as the variables in your <em>logistic regression</em> above (e.g. in this example the mean for <code>gre</code> must be named <code>gre</code>). Now that we have the data frame we want to use to calculate the predicted probabilities, we can tell R to create the predicted probabilities.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata1</span><span class="op">$</span><span class="va">rankP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mylogit</span>, newdata <span class="op">=</span> <span class="va">newdata1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">newdata1</span></span>
<span><span class="co">#     gre    gpa rank     rankP</span></span>
<span><span class="co"># 1 587.7 3.3899    1 0.5166016</span></span>
<span><span class="co"># 2 587.7 3.3899    2 0.3522846</span></span>
<span><span class="co"># 3 587.7 3.3899    3 0.2186120</span></span>
<span><span class="co"># 4 587.7 3.3899    4 0.1846684</span></span></code></pre></div>
<p>In the above output we see that the predicted probability of being accepted into a graduate program is <code>0.52</code> for students from the highest prestige undergraduate institutions (<code>rank</code>=1), and <code>0.18</code> for students from the lowest ranked institutions (<code>rank</code>=4), holding <code>gre</code> and <code>gpa</code> at their means. We can do something very similar to create a table of predicted probabilities varying the value of <code>gre</code> and <code>rank</code>. We are going to plot these, so we will create 100 values of <code>gre</code> between 200 and 800, at each value of <code>rank</code> (i.e., 1, 2, 3, and 4).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">200</span>, to <span class="op">=</span> <span class="fl">800</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, gpa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">gpa</span><span class="op">)</span>, rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The code to generate the predicted probabilities (the first line below) is the same as before, except we are also going to ask for standard errors so we can plot a confidence interval. We get the estimates on the link scale and back transform both the predicted values and confidence limits into probabilities.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">newdata2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mylogit</span>, newdata <span class="op">=</span> <span class="va">newdata2</span>, type <span class="op">=</span> <span class="st">"link"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdata3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">newdata3</span>, <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">PredictedProb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>    <span class="va">LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">fit</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1.96</span> <span class="op">*</span> <span class="va">se.fit</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">UL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">fit</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1.96</span> <span class="op">*</span> <span class="va">se.fit</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## view first few rows of final dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">newdata3</span><span class="op">)</span></span>
<span><span class="co">#        gre    gpa rank        fit    se.fit residual.scale        UL</span></span>
<span><span class="co"># 1 200.0000 3.3899    1 -0.8114870 0.5147714              1 0.5492064</span></span>
<span><span class="co"># 2 206.0606 3.3899    1 -0.7977632 0.5090986              1 0.5498513</span></span>
<span><span class="co"># 3 212.1212 3.3899    1 -0.7840394 0.5034491              1 0.5505074</span></span>
<span><span class="co"># 4 218.1818 3.3899    1 -0.7703156 0.4978239              1 0.5511750</span></span>
<span><span class="co"># 5 224.2424 3.3899    1 -0.7565919 0.4922237              1 0.5518545</span></span>
<span><span class="co"># 6 230.3030 3.3899    1 -0.7428681 0.4866494              1 0.5525464</span></span>
<span><span class="co">#          LL PredictedProb</span></span>
<span><span class="co"># 1 0.1393812     0.3075737</span></span>
<span><span class="co"># 2 0.1423880     0.3105042</span></span>
<span><span class="co"># 3 0.1454429     0.3134499</span></span>
<span><span class="co"># 4 0.1485460     0.3164108</span></span>
<span><span class="co"># 5 0.1516973     0.3193867</span></span>
<span><span class="co"># 6 0.1548966     0.3223773</span></span></code></pre></div>
<p>It can also be helpful to use graphs of predicted probabilities to understand and/or present the model. We will use the ggplot2 package for graphing. Below we make a plot with the predicted probabilities, and 95% confidence intervals.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata3</span> <span class="op">|&gt;</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gre</span>, y <span class="op">=</span> <span class="va">PredictedProb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">LL</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">UL</span>, fill <span class="op">=</span> <span class="va">rank</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">rank</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Logit_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>We may also wish to see measures of how well our model fits. This can be particularly useful when comparing competing models. The output produced by <code>summary(mylogit)</code> included indices of fit (shown below the coefficients), including the <strong>null and deviance residuals and the AIC</strong>. One measure of model fit is the significance of the overall model. This test asks whether the model with predictors fits significantly better than a model with just an intercept (i.e., a null model). The test statistic is the difference between the residual deviance for the model with predictors and the null model. The test statistic is distributed chi-squared with degrees of freedom equal to the differences in degrees of freedom between the current and the null model (i.e., the number of predictor variables in the model). To find the difference in deviance for the two models (i.e., the test statistic) we can use the command:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mylogit</span>, <span class="va">null.deviance</span> <span class="op">-</span> <span class="va">deviance</span><span class="op">)</span></span>
<span><span class="co"># [1] 41.45903</span></span></code></pre></div>
<p>The degrees of freedom for the difference between the two models is equal to the number of predictor variables in the mode, and can be obtained using:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mylogit</span>, <span class="va">df.null</span> <span class="op">-</span> <span class="va">df.residual</span><span class="op">)</span></span>
<span><span class="co"># [1] 5</span></span></code></pre></div>
<p>Finally, the p-value can be obtained using:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mylogit</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">null.deviance</span> <span class="op">-</span> <span class="va">deviance</span>, <span class="va">df.null</span> <span class="op">-</span> <span class="va">df.residual</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 7.578194e-08</span></span></code></pre></div>
<p>The chi-square of 41.46 with 5 degrees of freedom and an associated p-value of less than 0.001 tells us that our model as a whole fits significantly better than an empty model. This is sometimes called a likelihood ratio test (the deviance residual is -2*log likelihood). To see the model’s log likelihood, we type:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mylogit</span><span class="op">)</span></span>
<span><span class="co"># 'log Lik.' -229.2587 (df=6)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="thing-to-consider">Thing to Consider<a class="anchor" aria-label="anchor" href="#thing-to-consider"></a>
</h3>
<ul>
<li><p>Empty cells or small cells: You should check for empty or small cells by doing a crosstab between categorical predictors and the outcome variable. If a cell has very few cases (a small cell), the model may become unstable or it might not run at all.</p></li>
<li><p>Separation or quasi-separation (also called perfect prediction), a condition in which the outcome does not vary at some levels of the independent variables. See: <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faqwhat-is-complete-or-quasi-complete-separation-in-logisticprobit-regression-and-how-do-we-deal-with-them/" class="external-link">What is complete or quasi-complete separation in logistic/probit regression and how do we deal with them?</a> for information on models with perfect prediction.</p></li>
<li><p>Sample size: Both logit and probit models require more cases than OLS regression because they use maximum likelihood estimation techniques. It is sometimes possible to estimate models for binary outcomes in datasets with only a small number of cases using exact logistic regression. It is also important to keep in mind that when the outcome is rare, even if the overall dataset is large, it can be difficult to estimate a logit model.</p></li>
<li><p>Diagnostics: The diagnostics for logistic regression are different from those for OLS regression. For a discussion of model diagnostics for logistic regression, see Hosmer and Lemeshow (2000, Chapter 5). Note that diagnostics done for logistic regression are similar to those done for probit regression.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alejandro Abraham.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

  </div></footer>
</body>
</html>
